{"ast":null,"code":"import _classCallCheck from \"C:/Users/HP/Desktop/my_workspace/hackathon/NFT/Pixelate/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"C:/Users/HP/Desktop/my_workspace/hackathon/NFT/Pixelate/node_modules/@babel/runtime/helpers/esm/createClass.js\";\n/**\n * @typedef {import('@libp2p/interface-pubsub').Message} Message\n * @typedef {import('@libp2p/interfaces/events').EventHandler<Message>} MessageHandlerFn\n *\n * @typedef {object} Subscription\n * @property {MessageHandlerFn} handler\n * @property {AbortController} controller\n */\n\nexport var SubscriptionTracker = /*#__PURE__*/function () {\n  function SubscriptionTracker() {\n    _classCallCheck(this, SubscriptionTracker);\n    /** @type {Map<string, Subscription[]>} */\n    this._subs = new Map();\n  }\n\n  /**\n   * @param {string} topic\n   * @param {MessageHandlerFn} handler\n   * @param {AbortSignal} [signal]\n   */\n  _createClass(SubscriptionTracker, [{\n    key: \"subscribe\",\n    value: function subscribe(topic, handler, signal) {\n      var _this = this;\n      var topicSubs = this._subs.get(topic) || [];\n      if (topicSubs.find(function (s) {\n        return s.handler === handler;\n      })) {\n        throw new Error(\"Already subscribed to \".concat(topic, \" with this handler\"));\n      }\n\n      // Create controller so a call to unsubscribe can cancel the request\n      var controller = new AbortController();\n      this._subs.set(topic, [{\n        handler: handler,\n        controller: controller\n      }].concat(topicSubs));\n\n      // If there is an external signal, forward the abort event\n      if (signal) {\n        signal.addEventListener('abort', function () {\n          return _this.unsubscribe(topic, handler);\n        });\n      }\n      return controller.signal;\n    }\n\n    /**\n     * @param {string} topic\n     * @param {MessageHandlerFn} [handler]\n     */\n  }, {\n    key: \"unsubscribe\",\n    value: function unsubscribe(topic, handler) {\n      var subs = this._subs.get(topic) || [];\n      var unsubs;\n      if (handler) {\n        this._subs.set(topic, subs.filter(function (s) {\n          return s.handler !== handler;\n        }));\n        unsubs = subs.filter(function (s) {\n          return s.handler === handler;\n        });\n      } else {\n        this._subs.set(topic, []);\n        unsubs = subs;\n      }\n      if (!(this._subs.get(topic) || []).length) {\n        this._subs.delete(topic);\n      }\n      unsubs.forEach(function (s) {\n        return s.controller.abort();\n      });\n    }\n  }]);\n  return SubscriptionTracker;\n}();","map":{"version":3,"names":["SubscriptionTracker","_subs","Map","topic","handler","signal","topicSubs","get","find","s","Error","controller","AbortController","set","concat","addEventListener","unsubscribe","subs","unsubs","filter","length","delete","forEach","abort"],"sources":["C:/Users/HP/Desktop/my_workspace/hackathon/NFT/Pixelate/node_modules/ipfs-http-client/src/pubsub/subscription-tracker.js"],"sourcesContent":["\n/**\n * @typedef {import('@libp2p/interface-pubsub').Message} Message\n * @typedef {import('@libp2p/interfaces/events').EventHandler<Message>} MessageHandlerFn\n *\n * @typedef {object} Subscription\n * @property {MessageHandlerFn} handler\n * @property {AbortController} controller\n */\n\nexport class SubscriptionTracker {\n  constructor () {\n    /** @type {Map<string, Subscription[]>} */\n    this._subs = new Map()\n  }\n\n  /**\n   * @param {string} topic\n   * @param {MessageHandlerFn} handler\n   * @param {AbortSignal} [signal]\n   */\n  subscribe (topic, handler, signal) {\n    const topicSubs = this._subs.get(topic) || []\n\n    if (topicSubs.find(s => s.handler === handler)) {\n      throw new Error(`Already subscribed to ${topic} with this handler`)\n    }\n\n    // Create controller so a call to unsubscribe can cancel the request\n    const controller = new AbortController()\n\n    this._subs.set(topic, [{ handler, controller }].concat(topicSubs))\n\n    // If there is an external signal, forward the abort event\n    if (signal) {\n      signal.addEventListener('abort', () => this.unsubscribe(topic, handler))\n    }\n\n    return controller.signal\n  }\n\n  /**\n   * @param {string} topic\n   * @param {MessageHandlerFn} [handler]\n   */\n  unsubscribe (topic, handler) {\n    const subs = this._subs.get(topic) || []\n    let unsubs\n\n    if (handler) {\n      this._subs.set(topic, subs.filter(s => s.handler !== handler))\n      unsubs = subs.filter(s => s.handler === handler)\n    } else {\n      this._subs.set(topic, [])\n      unsubs = subs\n    }\n\n    if (!(this._subs.get(topic) || []).length) {\n      this._subs.delete(topic)\n    }\n\n    unsubs.forEach(s => s.controller.abort())\n  }\n}\n"],"mappings":";;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,WAAaA,mBAAmB;EAC9B,+BAAe;IAAA;IACb;IACA,IAAI,CAACC,KAAK,GAAG,IAAIC,GAAG,EAAE;EACxB;;EAEA;AACF;AACA;AACA;AACA;EAJE;IAAA;IAAA,OAKA,mBAAWC,KAAK,EAAEC,OAAO,EAAEC,MAAM,EAAE;MAAA;MACjC,IAAMC,SAAS,GAAG,IAAI,CAACL,KAAK,CAACM,GAAG,CAACJ,KAAK,CAAC,IAAI,EAAE;MAE7C,IAAIG,SAAS,CAACE,IAAI,CAAC,UAAAC,CAAC;QAAA,OAAIA,CAAC,CAACL,OAAO,KAAKA,OAAO;MAAA,EAAC,EAAE;QAC9C,MAAM,IAAIM,KAAK,iCAA0BP,KAAK,wBAAqB;MACrE;;MAEA;MACA,IAAMQ,UAAU,GAAG,IAAIC,eAAe,EAAE;MAExC,IAAI,CAACX,KAAK,CAACY,GAAG,CAACV,KAAK,EAAE,CAAC;QAAEC,OAAO,EAAPA,OAAO;QAAEO,UAAU,EAAVA;MAAW,CAAC,CAAC,CAACG,MAAM,CAACR,SAAS,CAAC,CAAC;;MAElE;MACA,IAAID,MAAM,EAAE;QACVA,MAAM,CAACU,gBAAgB,CAAC,OAAO,EAAE;UAAA,OAAM,KAAI,CAACC,WAAW,CAACb,KAAK,EAAEC,OAAO,CAAC;QAAA,EAAC;MAC1E;MAEA,OAAOO,UAAU,CAACN,MAAM;IAC1B;;IAEA;AACF;AACA;AACA;EAHE;IAAA;IAAA,OAIA,qBAAaF,KAAK,EAAEC,OAAO,EAAE;MAC3B,IAAMa,IAAI,GAAG,IAAI,CAAChB,KAAK,CAACM,GAAG,CAACJ,KAAK,CAAC,IAAI,EAAE;MACxC,IAAIe,MAAM;MAEV,IAAId,OAAO,EAAE;QACX,IAAI,CAACH,KAAK,CAACY,GAAG,CAACV,KAAK,EAAEc,IAAI,CAACE,MAAM,CAAC,UAAAV,CAAC;UAAA,OAAIA,CAAC,CAACL,OAAO,KAAKA,OAAO;QAAA,EAAC,CAAC;QAC9Dc,MAAM,GAAGD,IAAI,CAACE,MAAM,CAAC,UAAAV,CAAC;UAAA,OAAIA,CAAC,CAACL,OAAO,KAAKA,OAAO;QAAA,EAAC;MAClD,CAAC,MAAM;QACL,IAAI,CAACH,KAAK,CAACY,GAAG,CAACV,KAAK,EAAE,EAAE,CAAC;QACzBe,MAAM,GAAGD,IAAI;MACf;MAEA,IAAI,CAAC,CAAC,IAAI,CAAChB,KAAK,CAACM,GAAG,CAACJ,KAAK,CAAC,IAAI,EAAE,EAAEiB,MAAM,EAAE;QACzC,IAAI,CAACnB,KAAK,CAACoB,MAAM,CAAClB,KAAK,CAAC;MAC1B;MAEAe,MAAM,CAACI,OAAO,CAAC,UAAAb,CAAC;QAAA,OAAIA,CAAC,CAACE,UAAU,CAACY,KAAK,EAAE;MAAA,EAAC;IAC3C;EAAC;EAAA;AAAA"},"metadata":{},"sourceType":"module"}